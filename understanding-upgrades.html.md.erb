---
title: What Happens During PKS Upgrades
owner: PKS
---

This topic explains what happens to PKS-provisioned Kubernetes clusters during
PKS upgrades.

## <a id="introduction"></a>Introduction

PKS enables you to upgrade either the PKS tile and all PKS-provisioned Kubernetes clusters or only the PKS tile.

* [Upgrades of the PKS Tile and PKS-Provisioned Clusters](#upgrade-all)
* [Upgrades of the PKS Tile Only](#upgrade-tile)

During an upgrade of the PKS tile, your configuration settings are automatically migrated to the new tile version. For upgrading instructions, see [Upgrade PKS](upgrade-pks.html).

<p class="note warning"><strong>WARNING</strong>: If you upgrade the PKS tile from v1.0.x to v1.1, you must upgrade both the PKS tile and all PKS-provisioned Kubernetes clusters. This ensures existing clusters can run <code>resize</code> or <code>delete</code> commands after the upgrade.</p>

## <a id="upgrade-all"></a>Upgrades of the PKS Tile and PKS-Provisioned Clusters

During an upgrade of the PKS tile and PKS-provisioned clusters, the following occurs:

1. The PKS API server is recreated. This results in a short downtime of the API server.

1. Each of your Kubernetes clusters is recreated, one at a time. This includes the following stages for each cluster:
  1. Master nodes in the cluster are recreated. When PKS upgrades a single-master cluster, you cannot interact with your cluster, use the Kubernetes Command Line Interface (kubectl), or push new workloads. To avoid this loss of functionality during the upgrade, Pivotal recommends using multi-master clusters.
  1. Worker nodes are recreated. The upgrade runs on a single VM at a time. During the upgrade, the VM stops running containers. If your workloads run on a single VM, your apps will experience downtime. To avoid downtime, Pivotal recommends using at least three worker nodes per AZ.

  <p class="note"><strong>Note</strong>: When PKS is set to upgrade both the PKS tile and PKS-provisioned clusters, updating any stemcell in your deployment rolls every VM in each Kubernetes cluster. This ensures that all the VMs are patched. With the recommended resource configuration, no downtime is expected. For information about maintaining your Kubernetes workload uptime, see <a href="maintain-uptime.html">Maintain Workload Uptime</a>.</p>

## <a id="upgrade-tile"></a>Upgrades of the PKS Tile Only

During an upgrade of the PKS tile only, the PKS API server is recreated. This results in a short downtime of the API server.

<p class="note"><strong>Note</strong>: When PKS is set to upgrade the PKS tile only and not the clusters, the Kubernetes cluster version falls behind the PKS tile version. If the clusters fall more than one version behind the tile, PKS cannot upgrade the clusters. The clusters must be upgraded to match the PKS tile version before the next tile upgrade.</p>
